<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - KZMartMY</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
</head>
<body class="bg-[#0f1021] text-white flex items-center justify-center min-h-screen p-4">
    <div class="bg-[#1a1b3a] w-full max-w-md p-8 rounded-2xl border border-gray-800 shadow-2xl">
        <h2 class="text-3xl font-bold text-center mb-6 italic">KZMart<span class="text-red-600">MY</span></h2>
        
        <div id="auth-form" class="space-y-4">
            <input type="email" id="email" placeholder="Email" class="w-full bg-[#0f1021] border border-gray-700 rounded-xl p-3 outline-none focus:border-red-600">
            <input type="password" id="password" placeholder="Password" class="w-full bg-[#0f1021] border border-gray-700 rounded-xl p-3 outline-none focus:border-red-600">
            
            <button onclick="handleAuth()" id="btn-text" class="w-full bg-red-600 hover:bg-red-500 py-3 rounded-xl font-bold transition">Login / Sign Up</button>
        </div>
        
        <p id="msg" class="text-xs text-center mt-4 text-gray-400 font-medium"></p>
    </div>

    <script>
        // MASUKKAN CONFIG FIREBASE ANDA DI SINI
        const firebaseConfig = {
            apiKey: "AIzaSyAzqZNdN2Hq6gq7CqKsBRE7isgXZVFQChU",
            authDomain: "kzmart-auth.firebaseapp.com",
            projectId: "kzmart-auth",
            storageBucket: "kzmart-auth.firebasestorage.app",
            messagingSenderId: "1004515236820",
            appId: "1:1004515236820:web:502cb2e5cdb5181b5f9441",
            measurementId: "G-PV3MFPWWCZ"
        };


        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        async function handleAuth() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            const msg = document.getElementById('msg');
            const btn = document.getElementById('btn-text');

            if (!email || !password) {
                msg.innerText = "Sila isi emel dan password!";
                return;
            }

            btn.innerText = "Loading...";

            try {
                // 1. Cuba Login dulu
                await firebase.auth().signInWithEmailAndPassword(email, password);
                window.location.href = 'index.html';
            } catch (error) {
                // 2. Jika user tak wujud (error auth/user-not-found atau invalid-credential), cuba daftar baru
                if (error.code === 'auth/user-not-found' || error.code === 'auth/invalid-credential') {
                    try {
                        await firebase.auth().createUserWithEmailAndPassword(email, password);
                        alert("Akaun baru berjaya didaftarkan!");
                       window.location.href = 'index.html';
                   } catch (signUpError) {
                        msg.innerText = "Gagal daftar: " + signUpError.message;
                        btn.innerText = "Login / Sign Up";
                   }
                } else {
                    msg.innerText = "Ralat: " + error.message;
                    btn.innerText = "Login / Sign Up";
                }
            }
        }
    </script>
</body>
</html>